name: Test Dependabot Workflow Access

on:
  workflow_dispatch:
  push:
    branches:
      - main

jobs:
  test-workflow-access:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout this repo
        uses: actions/checkout@v4

      - name: Test checkout of reusable workflow repo
        uses: actions/checkout@v4
        with:
          repository: pivvenit/workflow-actions
          ref: main
          path: workflow-actions

      - name: Check if workflow file exists
        run: |
          echo "Checking if dependabot-auto-merge.yml exists..."
          if [ -f "workflow-actions/.github/workflows/dependabot-auto-merge.yml" ]; then
            echo "✓ Workflow file found!"
            echo "File contents:"
            cat workflow-actions/.github/workflows/dependabot-auto-merge.yml
          else
            echo "✗ Workflow file NOT found!"
            echo "Available files:"
            find workflow-actions -type f -name "*.yml" -o -name "*.yaml"
            exit 1
          fi

      - name: Validate workflow syntax
        run: |
          echo "Workflow file structure:"
          head -20 workflow-actions/.github/workflows/dependabot-auto-merge.yml
